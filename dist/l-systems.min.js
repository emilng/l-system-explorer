!function e(t,n,r){function i(s,c){if(!n[s]){if(!t[s]){var u="function"==typeof require&&require;if(!c&&u)return u(s,!0);if(a)return a(s,!0);var o=new Error("Cannot find module '"+s+"'");throw o.code="MODULE_NOT_FOUND",o}var l=n[s]={exports:{}};t[s][0].call(l.exports,function(e){var n=t[s][1][e];return i(n?n:e)},l,l.exports,e,t,n,r)}return n[s].exports}for(var a="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(e){var t=e("./encoder.js"),n=e("./parser.js"),r=e("./ui.js"),i=e("./render.js"),a={needsDecode:!0,needsRulesUIUpdate:!0,needsInstructionsUIUpdate:!0,needsParse:!0,needsRender:!0,selectedRule:-1,emptyRules:0,selectedInstructions:-1,emptyInstructions:0,replaceKey:function(e,t,n){return Object.keys(e).reduce(function(r,i){return i===t&&(r[n]=e[i]),r},{})}},s=document.getElementById("canvas"),c=r.getRuleTemplate(),u=r.getInstructionTemplate();r.initExamples(a),r.initRuleButtons(a),r.initInstructionButtons(a);var o=function(){if(a.needsDecode&&(t.decodeHash(a),r.initStart(a),r.initAxiom(a),a.needsDecode=!1,a.needsRulesUIUpdate=!0,a.needsParse=!0),a.needsRulesUIUpdate&&(r.updateRulesUI(c,a),a.needsRulesUIUpdate=!1),a.needsInstructionsUIUpdate&&(r.updateInstructionsUI(u,a),a.needsInstructionsUIUpdate=!1),a.needsParse&&(a.parsedRules=n.parse(a.rules,a.axiom,a.iterations),a.needsParse=!1,a.needsRender=!0),a.needsRender){var e=Math.min(a.parsedRules.length-1,a.start.iterations);i(s,a.start,a.parsedRules[e],a.instructions),a.needsRender=!1,window.location.hash=t.encodeHash(a)}requestAnimationFrame(o)};requestAnimationFrame(o)},{"./encoder.js":2,"./parser.js":3,"./render.js":4,"./ui.js":5}],2:[function(e,t){var n={decodeHash:function(e){var t=window.location.hash.substr(1);""===t&&(t="F/F:F+F-F-F+F/F,d3.5;+,a75;-,a-80/6/x347,y358,a70,i6");var n=t.split("/"),r=n[0],i=n[1],a=n[2],s=n[3],c=n[4];e.axiom=r.split(""),e.rules=this.decodeRules(i),e.instructions=this.decodeInstructions(a),e.iterations=s,e.start=this.decodeStart(c)},decodeRules:function(e){var t=e.split(",");return t.reduce(function(e,t){var n=t.split(":"),r=n[0],i=n[1].split("");return e[r]=i,e},{})},decodeInstructions:function(e){var t=e.split(";");return t.reduce(function(e,t){var n=t.split(","),r=n.shift();return e[r]=n.reduce(function(e,t){var n=t[0],r={d:"distance",a:"angle",b:"branch"},i=r[n],a=parseFloat(t.substr(1));return e[i]=a,e},{}),e},{})},decodeStart:function(e){var t=e.split(",");return t.reduce(function(e,t){var n=t[0],r={x:"x",y:"y",a:"angle",i:"iterations"},i=r[n],a=parseFloat(t.substr(1));return e[i]=a,e},{})},encodeHash:function(e){var t=e.axiom.join(""),n=this.encodeRules(e.rules),r=this.encodeInstructions(e.instructions),i=e.iterations,a=this.encodeStart(e.start);return"#"+[t,n,r,i,a].join("/")},encodeRules:function(e){var t=Object.keys(e),n=t.reduce(function(t,n){return t.push(n+":"+e[n].join("")),t},[]);return n.join(",")},encodeInstructions:function(e){var t=Object.keys(e),n=t.reduce(function(t,n){var r=e[n],i=Object.keys(r),a={distance:"d",angle:"a",branch:"b"},s=i.reduce(function(e,t){return e+","+a[t]+r[t]},"");return t.push(n+s),t},[]);return n.join(";")},encodeStart:function(e){var t=Object.keys(e),n={angle:"a",x:"x",y:"y",iterations:"i"},r=t.reduce(function(t,r){var i=n[r]+e[r];return t.push(i),t},[]);return r.join(",")}};t.exports=n},{}],3:[function(e,t){var n={parse:function(e,t,n){for(var r=[t],i=t,a=0;n>a;a++){var s=i.reduce(function(t,n){var r=void 0!==e[n]?e[n]:n;return t.concat(r)},[]);r.push(s),i=s.concat()}return r}};t.exports=n},{}],4:[function(e,t){var n=function(e,t,n,r){var i=e.getContext("2d");i.strokeStyle="black",i.lineWidth=1,i.clearRect(0,0,e.width,e.height);var a=t.x,s=t.y,c=t.angle,u=[],o=5,l=Math.PI/180;i.moveTo(a,s),i.beginPath();for(var d=0,p=n.length;p>d;d++){var h=n[d];if(r.hasOwnProperty(h)){var v=r[h];if(v.hasOwnProperty("angle")&&(c+=v.angle),v.hasOwnProperty("distance")&&(o=v.distance,a+=Math.cos(c*l)*o,s+=Math.sin(c*l)*o,i.lineTo(a,s)),v.hasOwnProperty("branch"))if(0===v.branch)u.push({angle:c,x:a,y:s});else if(1===v.branch&&u.length>0){var f=u.pop();c=f.angle,a=f.x,s=f.y,i.moveTo(a,s)}}}i.stroke(),i.closePath()};t.exports=n},{}],5:[function(e,t){var n={appendChildren:function(e,t){t.map(function(t){e.appendChild(t)})},getInstructionTemplate:function(){var e=function(e,t,n){var r=document.createElement(e);return t.map(function(e,t){r.setAttribute(e,n[t])}),r},t=function(t){var n=e("input",["type","value"],["checkbox",t]);return n},n=function(e,t){var n=document.createElement("label");return void 0!==t&&n.setAttribute("class",t),n.innerHTML=e,n},r=function(t,n){return e("input",["class","type","value"],[t,"radio",n])},i=n("Rule:"),a=document.createElement("input");a.setAttribute("class","rule-input");var s=n("distance","check-label"),c=t("distance"),u=n("angle","check-label"),o=t("angle"),l=n("branch","check-label"),d=t("branch"),p=e("div",["class"],["check-container"]);this.appendChildren(p,[s,c,u,o,l,d]);var h=n("distance:","distance-label"),v=e("input",["class","type","min","max","step","value"],["distance-input","range","0.1","20","0.1","4"]),f=n("angle:","angle-label"),m=e("input",["class","type","min","max","step","value"],["angle-input","range","-360","360","1","0"]),y=n("push"),g=r("branchPush-input","push"),b=n("pop"),I=r("branchPop-input","pop"),R=n("branch:","branch-label"),E=document.createElement("div");E.setAttribute("class","branch-container"),this.appendChildren(E,[y,g,b,I]);var k=document.createElement("div");return k.setAttribute("class","instruction-container"),this.appendChildren(k,[i,a,p,h,v,f,m,R,E]),k},getRuleTemplate:function(){var e=function(e,t){var n=document.createElement("label");return n.setAttribute("class",e),n.innerHTML=t,n},t=function(t,n){var r=document.createDocumentFragment(),i=e(t+"-label",n),a=document.createElement("input");return a.setAttribute("class",t+"-input"),r.appendChild(i),r.appendChild(a),r},n=e("inactive-indicator","&bullet;"),r=t("rule","rule:"),i=t("transform","->"),a=document.createElement("div");return a.setAttribute("class","rule-container"),this.appendChildren(a,[n,r,i]),a},initAxiom:function(e){var t=document.getElementById("axiom");t.value=e.axiom.join(""),t.addEventListener("input",function(t){e.axiom=t.currentTarget.value.split(""),e.needsParse=!0})},initRuleButtons:function(e){var t=document.getElementById("add-rule");t.addEventListener("click",function(){e.emptyRules+=1;var t=Object.keys(e.rules);e.selectedRule=t.length-1+e.emptyRules,e.needsRulesUIUpdate=!0});var n=document.getElementById("remove-rule");n.addEventListener("click",function(){if(e.emptyRules>0)e.emptyRules-=1;else{for(var t=Object.keys(e.rules),n=Math.max(t.length-1,0),r={};n--;){var i=t[n];r[i]=e.rules[i]}e.rules=r}e.selectedRule=Object.keys(e.rules).length-1+e.emptyRules,e.needsRulesUIUpdate=!0})},initInstructionButtons:function(e){var t=document.getElementById("add-instruction");t.addEventListener("click",function(){e.emptyInstructions+=1;var t=Object.keys(e.instructions);e.selectedInstructions=t.length-1+e.emptyInstructions,e.needsInstructionsUIUpdate=!0});var n=document.getElementById("remove-instruction");n.addEventListener("click",function(){if(e.emptyInstructions>0)e.emptyInstructions-=1;else{for(var t=Object.keys(e.instructions),n=Math.max(t.length-1,0),r={};n--;){var i=t[n];r[i]=e.instructions[i]}e.instructions=r}var a=Object.keys(e.instructions).length-1;e.selectedInstructions=a+e.emptyInstructions,e.needsInstructionsUIUpdate=!0})},updateRulesUI:function(e,t){var n,r=document.getElementById("rules-container"),i=Object.keys(t.rules),a=i.length+t.emptyRules-r.children.length,s=r.children.length;if(a>0)for(;a--;)n=e.cloneNode(!0),r.appendChild(n);else for(var c=-a;c--;)r.removeChild(r.lastElementChild);r.children.length!==s&&(t.needsParse=!0),Array.prototype.map.call(r.children,function(e,n){var r=e.children[0];if(n<i.length){var a=i[n];r.setAttribute("class","active-indicator");var s=e.querySelector(".rule-input");s.value=a,s.addEventListener("input",function(e){var n=e.currentTarget.value;n.length>0&&(n=n[0],i.hasOwnProperty(n)||(t.rules=t.replaceKey(t.rules,a,n),t.needsParse=!0))});var c=e.querySelector(".transform-input");c.value=t.rules[a].join(""),c.addEventListener("input",function(e){t.rules[a]=e.currentTarget.value.split(""),t.needsParse=!0})}else r.setAttribute("class","inactive-indicator");n===t.selectedRule?e.setAttribute("class","selected-rule-container"):e.setAttribute("class","rule-container"),e.addEventListener("click",function(){t.selectedRule=n,t.needsRulesUIUpdate=!0})})},updateInstructionsUI:function(e,t){var n,r=document.getElementById("instructions-container"),i=Object.keys(t.instructions),a=i.length+t.emptyInstructions-r.children.length;if(a>0)for(;a--;)n=e.cloneNode(!0),r.appendChild(n);else for(var s=-a;s--;)r.removeChild(r.lastElementChild);Array.prototype.map.call(r.children,function(e,n){var r=e.querySelector(".rule-input"),a=e.querySelectorAll('input[type="checkbox"]');Array.prototype.map.call(a,function(e){e.setAttribute("name","instruction-checkbox-"+n)});var s=e.querySelectorAll('input[type="radio"]');Array.prototype.map.call(s,function(e){e.setAttribute("name","instruction-radio-"+n)});var c=a[0],u=a[1],o=a[2],l=e.querySelector(".distance-label"),d=e.querySelector(".distance-input"),p=e.querySelector(".angle-label"),h=e.querySelector(".angle-input"),v=e.querySelector(".branch-label"),f=e.querySelector(".branch-container"),m=function(e){l.style.display=e?"inline":"none",d.style.display=e?"inline":"none",c.checked=e},y=function(e){p.style.display=e?"inline":"none",h.style.display=e?"inline":"none",u.checked=e},g=function(e){v.style.display=e?"inline":"none",f.style.display=e?"inline":"none",o.checked=e};if(c.addEventListener("change",function(e){m(e.currentTarget.checked)}),u.addEventListener("change",function(e){y(e.currentTarget.checked)}),o.addEventListener("change",function(e){g(e.currentTarget.checked)}),d.addEventListener("input",function(){}),n<i.length){var b=i[n];r.value=b;var I=t.instructions[b];m(I.hasOwnProperty("distance")),y(I.hasOwnProperty("angle")),g(I.hasOwnProperty("branch"))}})},initExamples:function(e){for(var t=document.getElementsByClassName("example"),n=t.length;n--;)t[n].addEventListener("click",function(t){window.location.hash=t.target.hash,e.needsDecode=!0})},initStart:function(e){var t=document.getElementById("start");Array.prototype.map.call(t.children,function(t){var n=t.id.split("-"),r=n[0];if("initial"===r){var i=n[1];t.value=e.start[i],t.addEventListener("input",function(t){e.start[i]=parseInt(t.currentTarget.value),e.needsRender=!0})}})}};t.exports=n},{}]},{},[1]);
//# sourceMappingURL=l-systems.min.js.map